library(here)
library(tidyverse)

pdo <- read.csv(here("Data", "PDO.csv"))

####
#PDO full-year; Jan-Dec
pi_full_pdo <- pdo[which(pdo$Year >= 1995),]
pi_full_pdo[pi_full_pdo == 99.99] <- NA
pdo_holder <- rep(NA, nrow(pi_full_pdo))

pi_full_pdo <- cbind(pi_full_pdo, pdo_holder)
pi_full_pdo$pdo_holder <- rowMeans(pi_full_pdo[,2:13], na.rm=TRUE)
pi_year_pdo <- pi_full_pdo[,c(1, 14)]
colnames(pi_year_pdo) <- c("Year", "PDO")

####
#PDO full-year; July-June
full96 <- cbind(pi_full_pdo[1,8:13], pi_full_pdo[2,2:7])
full97 <- cbind(pi_full_pdo[2,8:13], pi_full_pdo[3,2:7])
full98 <- cbind(pi_full_pdo[3,8:13], pi_full_pdo[4,2:7])
full99 <- cbind(pi_full_pdo[4,8:13], pi_full_pdo[5,2:7])
full00 <- cbind(pi_full_pdo[5,8:13], pi_full_pdo[6,2:7])
full01 <- cbind(pi_full_pdo[6,8:13], pi_full_pdo[7,2:7])
full02 <- cbind(pi_full_pdo[7,8:13], pi_full_pdo[8,2:7])
full03 <- cbind(pi_full_pdo[8,8:13], pi_full_pdo[9,2:7])
full04 <- cbind(pi_full_pdo[9,8:13], pi_full_pdo[10,2:7])
full05 <- cbind(pi_full_pdo[10,8:13], pi_full_pdo[11,2:7])
full06 <- cbind(pi_full_pdo[11,8:13], pi_full_pdo[12,2:7])
full07 <- cbind(pi_full_pdo[12,8:13], pi_full_pdo[13,2:7])
full08 <- cbind(pi_full_pdo[13,8:13], pi_full_pdo[14,2:7])
full09 <- cbind(pi_full_pdo[14,8:13], pi_full_pdo[15,2:7])
full10 <- cbind(pi_full_pdo[15,8:13], pi_full_pdo[16,2:7])
full11 <- cbind(pi_full_pdo[16,8:13], pi_full_pdo[17,2:7])
full12 <- cbind(pi_full_pdo[17,8:13], pi_full_pdo[18,2:7])
full13 <- cbind(pi_full_pdo[18,8:13], pi_full_pdo[19,2:7])
full14 <- cbind(pi_full_pdo[19,8:13], pi_full_pdo[20,2:7])
full15 <- cbind(pi_full_pdo[20,8:13], pi_full_pdo[21,2:7])
full16 <- cbind(pi_full_pdo[21,8:13], pi_full_pdo[22,2:7])
full17 <- cbind(pi_full_pdo[22,8:13], pi_full_pdo[23,2:7])
full18 <- cbind(pi_full_pdo[23,8:13], pi_full_pdo[24,2:7])
full19 <- cbind(pi_full_pdo[24,8:13], pi_full_pdo[25,2:7])
full20 <- cbind(pi_full_pdo[25,8:13], pi_full_pdo[26,2:7])
full21 <- cbind(pi_full_pdo[26,8:13], pi_full_pdo[27,2:7])
full22 <- cbind(pi_full_pdo[27,8:13], pi_full_pdo[28,2:7])
full23 <- cbind(pi_full_pdo[28,8:13], pi_full_pdo[29,2:7])

pi_full_rnames <- seq(1996, 2023, 1)
pi_full2_pdo <- rbind(full96, full97, full98, full99, full00, full01, full02, full03, full04, full05, full06, full07, full08, full09, full10, full11, full12, full13, full14, full15, full16, full17, full18, full19, full20, full21, full22, full23)
pi_full2_pdo <- cbind(pi_full_rnames, pi_full2_pdo)
pi_full2_pdo <- cbind(pi_full2_pdo, pdo_holder[1:28])

pi_full2_pdo$`pdo_holder[1:28]` <- rowMeans(pi_full2_pdo[,2:13], na.rm=TRUE)
pi_full2_pdo <- pi_full2_pdo[,c(1,14)]
colnames(pi_full2_pdo) <- c("Year", "PDO")

####
#PDO pre-breeding season; Jan-Apr
pi_pre_pdo <- cbind(pi_full_pdo[,1:5], pdo_holder)
pi_pre_pdo$pdo_holder <- rowMeans(pi_pre_pdo[,2:5], na.rm=TRUE)
pi_pre_pdo <- pi_pre_pdo[,c(1,6)]
colnames(pi_pre_pdo) <- c("Year", "PDO")

####
#breeding season; May - Sept
pi_breeding_pdo <- cbind(pi_full_pdo[,c(1,6:10)], pdo_holder)
pi_breeding_pdo$pdo_holder <- rowMeans(pi_breeding_pdo[,2:6], na.rm=TRUE)
pi_breeding_pdo <- pi_breeding_pdo[,c(1,7)]
colnames(pi_breeding_pdo) <- c("Year", "PDO")


####
#winter; Oct-Mar
winter96 <- cbind(pi_full_pdo[1,11:13], pi_full_pdo[2,2:4])
winter97 <- cbind(pi_full_pdo[2,11:13], pi_full_pdo[3,2:4])
winter98 <- cbind(pi_full_pdo[3,11:13], pi_full_pdo[4,2:4])
winter99 <- cbind(pi_full_pdo[4,11:13], pi_full_pdo[5,2:4])
winter00 <- cbind(pi_full_pdo[5,11:13], pi_full_pdo[6,2:4])
winter01 <- cbind(pi_full_pdo[6,11:13], pi_full_pdo[7,2:4])
winter02 <- cbind(pi_full_pdo[7,11:13], pi_full_pdo[8,2:4])
winter03 <- cbind(pi_full_pdo[8,11:13], pi_full_pdo[9,2:4])
winter04 <- cbind(pi_full_pdo[9,11:13], pi_full_pdo[10,2:4])
winter05 <- cbind(pi_full_pdo[10,11:13], pi_full_pdo[11,2:4])
winter06 <- cbind(pi_full_pdo[11,11:13], pi_full_pdo[12,2:4])
winter07 <- cbind(pi_full_pdo[12,11:13], pi_full_pdo[13,2:4])
winter08 <- cbind(pi_full_pdo[13,11:13], pi_full_pdo[14,2:4])
winter09 <- cbind(pi_full_pdo[14,11:13], pi_full_pdo[15,2:4])
winter10 <- cbind(pi_full_pdo[15,11:13], pi_full_pdo[16,2:4])
winter11 <- cbind(pi_full_pdo[16,11:13], pi_full_pdo[17,2:4])
winter12 <- cbind(pi_full_pdo[17,11:13], pi_full_pdo[18,2:4])
winter13 <- cbind(pi_full_pdo[18,11:13], pi_full_pdo[19,2:4])
winter14 <- cbind(pi_full_pdo[19,11:13], pi_full_pdo[20,2:4])
winter15 <- cbind(pi_full_pdo[20,11:13], pi_full_pdo[21,2:4])
winter16 <- cbind(pi_full_pdo[21,11:13], pi_full_pdo[22,2:4])
winter17 <- cbind(pi_full_pdo[22,11:13], pi_full_pdo[23,2:4])
winter18 <- cbind(pi_full_pdo[23,11:13], pi_full_pdo[24,2:4])
winter19 <- cbind(pi_full_pdo[24,11:13], pi_full_pdo[25,2:4])
winter20 <- cbind(pi_full_pdo[25,11:13], pi_full_pdo[26,2:4])
winter21 <- cbind(pi_full_pdo[26,11:13], pi_full_pdo[27,2:4])
winter22 <- cbind(pi_full_pdo[27,11:13], pi_full_pdo[28,2:4])
winter23 <- cbind(pi_full_pdo[28,11:13], pi_full_pdo[29,2:4])

pi_winter_rnames <- seq(1996, 2023, 1)
pi_winter_pdo <- rbind(winter96, winter97, winter98, winter99, winter00, winter01, winter02, winter03, winter04, winter05, winter06, winter07, winter08, winter09, winter10, winter11, winter12, winter13, winter14, winter15, winter16, winter17, winter18, winter19, winter20, winter21, winter22, winter23)
pi_winter_pdo <- cbind(pi_winter_rnames, pi_winter_pdo)
pi_winter_pdo <- cbind(pi_winter_pdo, pdo_holder[1:28])

pi_winter_pdo$`pdo_holder[1:28]` <- rowMeans(pi_winter_pdo[,2:7], na.rm=TRUE)
pi_winter_pdo <- pi_winter_pdo[,c(1,8)]
colnames(pi_winter_pdo) <- c("Year", "PDO")

####
#clean things up in environment
rm(pdo)
rm(pi_full_pdo)
rm(winter96)
rm(winter97)
rm(winter98)
rm(winter99)
rm(winter00)
rm(winter01)
rm(winter02)
rm(winter03)
rm(winter04)
rm(winter05)
rm(winter06)
rm(winter07)
rm(winter08)
rm(winter09)
rm(winter10)
rm(winter11)
rm(winter12)
rm(winter13)
rm(winter14)
rm(winter15)
rm(winter16)
rm(winter17)
rm(winter18)
rm(winter19)
rm(winter20)
rm(winter21)
rm(winter22)
rm(winter23)
rm(pdo_holder)
rm(pi_winter_rnames)
rm(full96)
rm(full97)
rm(full98)
rm(full99)
rm(full00)
rm(full01)
rm(full02)
rm(full03)
rm(full04)
rm(full05)
rm(full06)
rm(full07)
rm(full08)
rm(full09)
rm(full10)
rm(full11)
rm(full12)
rm(full13)
rm(full14)
rm(full15)
rm(full16)
rm(full17)
rm(full18)
rm(full19)
rm(full20)
rm(full21)
rm(full22)
rm(full23)
rm(pi_full_rnames)
